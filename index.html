<script>
const questions = [
    {
        question: "What does AI stand for?",
        options: ["Artificial Intelligence", "Automated Input", "Algorithmic Interface", "Advanced Integration"],
        answer: 0,
        explanation: "AI stands for 'Artificial Intelligence', which refers to the simulation of human intelligence by machines."
    },
    {
        question: "Which of these is an example of AI application?",
        options: ["Spam Email Filtering", "Word Processing", "File Compression", "Disk Cleanup"],
        answer: 0,
        explanation: "Spam email filtering uses AI algorithms to detect and block unwanted messages."
    },
    {
        question: "Who is considered the father of AI?",
        options: ["Alan Turing", "Bill Gates", "Elon Musk", "Ada Lovelace"],
        answer: 0,
        explanation: "Alan Turing's pioneering work laid the foundation for modern artificial intelligence."
    },
    {
        question: "What is Machine Learning?",
        options: [
            "A method for machines to learn from data",
            "A way to clean computer parts",
            "A programming language",
            "A type of hardware"
        ],
        answer: 0,
        explanation: "Machine learning is a subset of AI that allows computers to learn from data without being explicitly programmed."
    },
    {
        question: "Which AI system defeated the world chess champion Garry Kasparov in 1997?",
        options: ["Deep Blue", "AlphaGo", "Watson", "Siri"],
        answer: 0,
        explanation: "IBM's Deep Blue defeated Garry Kasparov, marking a milestone in AI history."
    },
    {
        question: "Natural Language Processing (NLP) is used for what?",
        options: [
            "Understanding and generating human language",
            "Image recognition",
            "Playing chess",
            "Hardware design"
        ],
        answer: 0,
        explanation: "NLP enables computers to understand, interpret, and generate human language."
    }
];

const timeLimit = 30; // seconds
let currentQuestion = 0;
let score = 0;
let timeLeft = timeLimit;
let timerInterval = null;

function startQuiz() {
    document.getElementById('intro').style.display = 'none';
    document.getElementById('outro').style.display = 'none';
    document.getElementById('quiz').style.display = '';
    currentQuestion = 0;
    score = 0;
    loadQuestion();
}

function loadQuestion() {
    if (currentQuestion >= questions.length) {
        endQuiz();
        return;
    }
    const q = questions[currentQuestion];
    document.getElementById('questionText').textContent = q.question;
    const optionsDiv = document.getElementById('options');
    optionsDiv.innerHTML = '';
    q.options.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(idx);
        optionsDiv.appendChild(btn);
    });
    document.getElementById('result').textContent = '';
    document.getElementById('result').classList.remove('wrong');
    // Remove previous explanation if any
    let explanationEl = document.getElementById('explanation');
    if (explanationEl) explanationEl.remove();
    startTimer();
}

function checkAnswer(selected) {
    clearInterval(timerInterval);
    setTimerBar(0);
    const q = questions[currentQuestion];
    const resultDiv = document.getElementById('result');
    // Remove previous explanation if any
    let explanationEl = document.getElementById('explanation');
    if (explanationEl) explanationEl.remove();

    if (selected === q.answer) {
        resultDiv.textContent = "✅ Correct!";
        resultDiv.classList.remove('wrong');
        score++;
        // Show the explanation for the correct answer
        showExplanation(q.explanation);
    } else {
        resultDiv.textContent = `❌ Wrong! The correct answer was "${q.options[q.answer]}".`;
        resultDiv.classList.add('wrong');
    }
    disableOptions();
    setTimeout(() => {
        currentQuestion++;
        loadQuestion();
    }, 2000);
}

function showExplanation(text) {
    let explanationEl = document.createElement('div');
    explanationEl.id = 'explanation';
    explanationEl.style.fontSize = '0.98em';
    explanationEl.style.marginTop = '0.7em';
    explanationEl.style.color = '#1abf6e';
    explanationEl.style.textAlign = 'center';
    explanationEl.textContent = text;
    document.getElementById('result').after(explanationEl);
}

function disableOptions() {
    const btns = document.querySelectorAll('.options button');
    btns.forEach(btn => btn.disabled = true);
}

function startTimer() {
    timeLeft = timeLimit;
    setTimerBar(100);
    const timerBarBg = document.querySelector('.timer-bar-bg');
    timerBarBg.classList.remove('timer-warning');
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        timeLeft--;
        setTimerBar((timeLeft/timeLimit)*100);
        if (timeLeft <= 10) {
            timerBarBg.classList.add('timer-warning');
        }
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            setTimerBar(0);
            document.getElementById('result').textContent = "⏰ Time's up!";
            document.getElementById('result').classList.add('wrong');
            disableOptions();
            setTimeout(() => {
                currentQuestion++;
                loadQuestion();
            }, 1200);
        }
    }, 1000);
}

function setTimerBar(percent) {
    const timerBar = document.getElementById('timerBar');
    timerBar.style.width = percent + '%';
}

function endQuiz() {
    document.getElementById('quiz').style.display = 'none';
    document.getElementById('outro').style.display = '';
    document.getElementById('finalScore').textContent = 
        `You scored ${score} out of ${questions.length}!`;
}

function restartQuiz() {
    startQuiz();
}
</script>
