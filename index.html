<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI and US</title>
    <!-- Keep your style section as it is, since it doesn't affect game logic -->
    <style>
        /* ... [keep your existing CSS unchanged] ... */
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">ü§ñ AI and US</h1>
        <p class="subtitle">Test your understanding of AI definitions and concepts</p>
        <div class="level-display" id="levelDisplay">Level 1</div>
        <div class="level-display" id="scoreDisplay" style="background: rgba(46, 204, 113, 0.3); border: 2px solid #2ecc71;">Score: 0</div>
        <div class="timer-display" id="timerDisplay" style="display: none;">Time: 30s</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar" style="width: 0%"></div>
        </div>
        <div class="question-container" id="questionContainer">
            <div class="question" id="question">Click "Start Quiz" to begin your AI knowledge journey!</div>
            <div class="options" id="options" style="display: none;"></div>
            <div class="feedback" id="feedback" style="display: none;"></div>
            <button class="btn" id="startBtn">Start Quiz</button>
            <button class="btn" id="nextBtn" style="display: none;">Next Level</button>
            <button class="btn" id="restartBtn" style="display: none;">Try Again</button>
        </div>
        <div class="leaderboard" id="leaderboard" style="display: none;">
            <h3>üèÜ Top Players</h3>
            <div id="leaderboardList"></div>
        </div>
    </div>
    <script>
        // Polyfill for localStorage if not available
        if (!window.localStorage) {
            window.localStorage = {
                _data: {},
                setItem: function(id, val) { this._data[id] = String(val); },
                getItem: function(id) { return this._data.hasOwnProperty(id) ? this._data[id] : undefined; },
                removeItem: function(id) { delete this._data[id]; },
                clear: function() { this._data = {}; }
            };
        }

        let currentLevel = 1;
        let currentScore = 0;
        let gameActive = false;
        let timeLeft = 30;
        let timerInterval = null;
        const totalLevels = 10;
        const pointsPerCorrectAnswer = 100;
        const timeLimit = 30;

        const questions = [
            /* ... [keep your questions array unchanged] ... */
        ];

        function $(id) { return document.getElementById(id); }

        function loadLeaderboard() {
            const saved = localStorage.getItem('aiAndUsLeaderboard');
            return saved ? JSON.parse(saved) : [];
        }

        function saveLeaderboard(leaderboard) {
            localStorage.setItem('aiAndUsLeaderboard', JSON.stringify(leaderboard));
        }

        function displayLeaderboard() {
            const leaderboard = loadLeaderboard();
            const leaderboardDiv = $('leaderboard');
            const leaderboardList = $('leaderboardList');
            if (leaderboard.length > 0) {
                leaderboardDiv.style.display = 'block';
                leaderboardList.innerHTML = leaderboard
                    .sort((a, b) => b.score - a.score || b.level - a.level)
                    .slice(0, 5)
                    .map((entry, index) => `
                        <div class="leaderboard-item">
                            <span>${index + 1}. ${entry.name}</span>
                            <span>Level ${entry.level} - ${entry.score || 0} pts</span>
                        </div>
                    `).join('');
            }
        }

        function updateScoreDisplay() {
            $('scoreDisplay').textContent = `Score: ${currentScore}`;
        }

        function startTimer() {
            timeLeft = timeLimit;
            updateTimerDisplay();
            $('timerDisplay').style.display = 'inline-block';
            $('timerDisplay').classList.remove('timer-warning');
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 10) {
                    $('timerDisplay').classList.add('timer-warning');
                }
                if (timeLeft <= 0) {
                    timeUp();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            $('timerDisplay').textContent = `Time: ${timeLeft}s`;
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            $('timerDisplay').classList.remove('timer-warning');
        }

        function timeUp() {
            if (!gameActive) return;
            stopTimer();
            gameActive = false;
            const question = questions[currentLevel - 1];
            const options = document.querySelectorAll('.option');
            const feedback = $('feedback');
            options.forEach(option => option.style.pointerEvents = 'none');
            if (options[question.correct]) options[question.correct].classList.add('correct');
            currentScore = 0;
            updateScoreDisplay();
            feedback.className = 'feedback incorrect';
            feedback.innerHTML = `
                <strong>‚è∞ Time's Up! Score reset to 0</strong><br>
                The correct answer was: ${question.options[question.correct]}<br>
                ${question.explanation}<br><br>
                <strong>You must start over from Level 1!</strong>
            `;
            feedback.style.display = 'block';
            $('restartBtn').style.display = 'inline-block';
        }

        function startQuiz() {
            gameActive = true;
            currentLevel = 1;
            currentScore = 0;
            $('startBtn').style.display = 'none';
            $('options').style.display = 'grid';
            updateScoreDisplay();
            loadQuestion();
        }

        function loadQuestion() {
            if (currentLevel > totalLevels) {
                gameComplete();
                return;
            }
            const question = questions[currentLevel - 1];
            $('question').textContent = question.question;
            $('levelDisplay').textContent = `Level ${currentLevel}`;
            const progress = ((currentLevel - 1) / totalLevels) * 100;
            $('progressBar').style.width = progress + '%';
            const optionsDiv = $('options');
            optionsDiv.innerHTML = '';
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index);
                optionsDiv.appendChild(optionDiv);
            });
            $('feedback').style.display = 'none';
            $('nextBtn').style.display = 'none';
            $('restartBtn').style.display = 'none';
            startTimer();
        }

        function selectAnswer(selectedIndex) {
            if (!gameActive) return;
            stopTimer();
            const question = questions[currentLevel - 1];
            const options = document.querySelectorAll('.option');
            const feedback = $('feedback');
            options.forEach(option => option.style.pointerEvents = 'none');
            if (selectedIndex === question.correct) {
                currentScore += pointsPerCorrectAnswer;
                updateScoreDisplay();
                options[selectedIndex].classList.add('correct');
                feedback.className = 'feedback correct';
                feedback.innerHTML = `
                    <strong>‚úÖ Correct! +${pointsPerCorrectAnswer} points</strong><br>
                    ${question.explanation}
                `;
                feedback.style.display = 'block';
                if (currentLevel < totalLevels) {
                    $('nextBtn').style.display = 'inline-block';
                } else {
                    setTimeout(gameComplete, 1500);
                }
            } else {
                currentScore = 0;
                updateScoreDisplay();
                options[selectedIndex].classList.add('incorrect');
                if (options[question.correct]) options[question.correct].classList.add('correct');
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `
                    <strong>‚ùå Wrong Answer! Score reset to 0</strong><br>
                    ${question.explanation}<br><br>
                    <strong>You must start over from Level 1!</strong>
                `;
                feedback.style.display = 'block';
                $('restartBtn').style.display = 'inline-block';
                gameActive = false;
            }
        }

        function nextQuestion() {
            currentLevel++;
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.style.pointerEvents = 'auto';
                option.classList.remove('correct', 'incorrect');
            });
            $('timerDisplay').style.display = 'none';
            loadQuestion();
        }

        function restartGame() {
            stopTimer();
            currentLevel = 1;
            currentScore = 0;
            gameActive = true;
            updateScoreDisplay();
            $('timerDisplay').style.display = 'none';
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.style.pointerEvents = 'auto';
                option.classList.remove('correct', 'incorrect');
            });
            loadQuestion();
        }

        function gameComplete() {
            stopTimer();
            $('question').innerHTML = `
                <div class="celebration">üéâ Congratulations! üéâ</div>
                <br>You've completed all ${totalLevels} levels!<br>
                <strong>Final Score: ${currentScore} points</strong><br>
                <strong>You are now an AI Knowledge Expert!</strong>
            `;
            $('options').style.display = 'none';
            $('feedback').style.display = 'none';
            $('nextBtn').style.display = 'none';
            $('timerDisplay').style.display = 'none';
            $('progressBar').style.width = '100%';
            const playerName = prompt("Enter your name for the leaderboard:") || "Anonymous";
            const leaderboard = loadLeaderboard();
            leaderboard.push({
                name: playerName,
                level: totalLevels,
                score: currentScore,
                timestamp: new Date().toISOString()
            });
            saveLeaderboard(leaderboard);
            displayLeaderboard();
            $('restartBtn').style.display = 'inline-block';
            $('restartBtn').textContent = 'Play Again';
        }

        // Event listeners for buttons
        document.addEventListener('DOMContentLoaded', function() {
            $('startBtn').onclick = startQuiz;
            $('nextBtn').onclick = nextQuestion;
            $('restartBtn').onclick = restartGame;
            displayLeaderboard();
        });
    </script>
</body>
</html>
